(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ab841fe"],{"0bfb":function(t,e,a){"use strict";var n=a("cb7c");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"11e9":function(t,e,a){var n=a("52a7"),i=a("4630"),o=a("6821"),r=a("6a99"),s=a("69a8"),c=a("c69a"),l=Object.getOwnPropertyDescriptor;e.f=a("9e1e")?l:function(t,e){if(t=o(t),e=r(e,!0),c)try{return l(t,e)}catch(a){}if(s(t,e))return i(!n.f.call(t,e),t[e])}},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"454f":function(t,e,a){a("46a7");var n=a("584a").Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},"456d":function(t,e,a){var n=a("4bf8"),i=a("0d58");a("5eda")("keys",function(){return function(t){return i(n(t))}})},"46a7":function(t,e,a){var n=a("63b6");n(n.S+n.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"49f7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"document-setting"},[t.showAddManage?t._e():a("div",{staticClass:"document-setting-warpper"},[a("div",{staticClass:"nav"},[a("div",{staticClass:"nav-item",class:{active:0==t.active},on:{click:function(e){return t.onClickNav(0)}}},[0==t.active?a("p",{staticClass:"light-line"}):t._e(),t._v("\n        项目概览\n      ")]),a("div",{staticClass:"nav-item",class:{active:1==t.active},on:{click:function(e){return t.onClickNav(1)}}},[1==t.active?a("p",{staticClass:"light-line"}):t._e(),t._v("\n        权限管理\n      ")]),a("div",{staticClass:"nav-item",class:{active:2==t.active},on:{click:function(e){return t.onClickNav(2)}}},[2==t.active?a("p",{staticClass:"light-line"}):t._e(),t._v("\n        历史记录\n      ")])]),a("div",{staticClass:"content"},[0==t.active?a("div",{staticClass:"project"},[a("el-form",{key:"doc",ref:"docForm",staticClass:"w7-form__no-required-icon",attrs:{model:t.docData,rules:t.rules,"label-width":"85px","label-position":"left"}},[a("el-form-item",{staticClass:"cover-warpper",attrs:{label:"项目封面"}},[a("div",{staticClass:"upload-wrap"},[a("el-upload",{ref:"upload",attrs:{action:"/admin/upload/image",accept:".jpg,.jpeg,.png","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[a("div",{staticClass:"cover-img"},[t.docData.cover?a("img",{attrs:{src:t.docData.cover}}):t._e()])]),a("div",{staticClass:"cover-btn"},[a("el-upload",{ref:"upload",attrs:{action:"/admin/upload/image",accept:".jpg,.jpeg,.png","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[a("el-button",{attrs:{type:"primary",plain:""}},[t._v("上传封面")])],1),a("el-button",{staticClass:"cover-default",on:{click:function(e){t.docData.cover=""}}},[t._v("默认封面")])],1)],1),a("div",{staticClass:"el-upload__tip"},[t._v("格式要求：支持jpg、jpeg、png格式，图片小于5M，最佳图片比例2:1。")])]),a("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[a("el-input",{model:{value:t.docData.name,callback:function(e){t.$set(t.docData,"name",e)},expression:"docData.name"}})],1),a("el-form-item",{attrs:{label:"公开性质"}},[a("el-select",{model:{value:t.docData.is_public,callback:function(e){t.$set(t.docData,"is_public",e)},expression:"docData.is_public"}},[a("el-option",{attrs:{label:"私有项目",value:"1"}}),a("el-option",{attrs:{label:"公开项目",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"查看权限"}},[a("el-select",{model:{value:t.docData.login_preview,callback:function(e){t.$set(t.docData,"login_preview",e)},expression:"docData.login_preview"}},[a("el-option",{attrs:{label:"仅限有权限者查看",value:"1"}}),a("el-option",{attrs:{label:"点击链接登录后查看",value:"2"}})],1)],1)],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveDoc}},[t._v("保存")]),a("el-button",{on:{click:t.delDoc}},[t._v("删除")])],1)],1):t._e(),1==t.active?a("div",{staticClass:"manage"},[a("div",{staticClass:"top"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.openAddManage}},[t._v("添加权限")])],1),a("el-table",{key:"manageTable",staticClass:"w7-table",attrs:{data:t.details.operator,"header-cell-style":{background:"#f7f9fc",color:"#606266"},"max-height":"390"}},[a("el-table-column",{attrs:{prop:"username",label:"名称",width:"300px"}}),a("el-table-column",{attrs:{label:"身份",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.acl.role?a("div",{staticClass:"identity"},[t._v(t._s(e.row.acl.name))]):[t._v(t._s(e.row.acl.name))]]}}],null,!1,565636675)}),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"oper"},[a("el-tooltip",{attrs:{effect:"dark",content:"编辑",placement:"bottom"}},[t.details.acl.has_manage&&1!=e.row.acl.role?a("i",{staticClass:"wi wi-edit",on:{click:function(a){return t.editManage(e.row)}}}):t._e()]),a("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"bottom"}},[t.details.acl.has_manage&&1!=e.row.acl.role?a("i",{staticClass:"wi wi-delete",on:{click:function(a){return t.removeManage(e.row.id)}}}):t._e()]),t.shwoEditRole&&t.selectUserId==e.row.id?a("div",{staticClass:"edit-role"},[a("div",{staticClass:"edit-role-content"},[a("div",{staticClass:"label"},[t._v("权限:")]),a("el-select",{model:{value:t.selectUserRole,callback:function(e){t.selectUserRole=e},expression:"selectUserRole"}},t._l(t.role_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),a("div",{staticClass:"edit-role-foot"},[a("el-button",{attrs:{type:"primary"},on:{click:t.editRole}},[t._v("确定")]),a("el-button",{on:{click:function(e){t.shwoEditRole=!1}}},[t._v("取消")])],1)]):t._e()],1)}}],null,!1,3184500167)})],1)],1):t._e(),2==t.active?a("div",{staticClass:"history"},[a("el-table",{key:"historyTable",ref:"historyTableRef",staticClass:"w7-table",attrs:{data:t.historyList,"max-height":"370"}},[a("el-table-column",{attrs:{prop:"remark",label:"描述"}}),a("el-table-column",{attrs:{prop:"time",label:"时间",align:"right"}})],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total","prev-text":"上一页","next-text":"下一页","page-size":5,"current-page":t.currentPageHistory,"page-count":t.pageCountHistory,"hide-on-single-page":!0},on:{"current-change":t.getHistory,"update:currentPage":function(e){t.currentPageHistory=e},"update:current-page":function(e){t.currentPageHistory=e}}})],1):t._e()])]),t.showAddManage?a("div",{staticClass:"add-manage-header"},[a("el-link",{attrs:{underline:!1},on:{click:function(e){t.showAddManage=!1}}},[a("i",{staticClass:"el-icon-arrow-left"}),t._v("添加权限")]),a("el-link",{attrs:{underline:!1},on:{click:function(e){t.showAddManage=!1}}},[a("i",{staticClass:"el-icon-close"})])],1):t._e(),t.showAddManage?a("div",{staticClass:"add-manage-body"},[a("el-form",{key:"addManage",ref:"addManageForm",staticClass:"w7-form__no-required-icon",attrs:{model:t.addManageData,rules:t.rules,"label-width":"85px","label-position":"left"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:t.addManageData.username,callback:function(e){t.$set(t.addManageData,"username",e)},expression:"addManageData.username"}})],1),a("el-form-item",{attrs:{label:"操作员权限"}},[a("el-select",{model:{value:t.addManageData.role,callback:function(e){t.$set(t.addManageData,"role",e)},expression:"addManageData.role"}},t._l(t.role_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1),a("div",{staticClass:"add-manage-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addManage}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.showAddManage=!1}}},[t._v("取 消")])],1)],1):t._e()])},i=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86"));a("7f7f");function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(a,!0).forEach(function(e){Object(o["a"])(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var c={name:"setting",props:["id"],data:function(){return{active:0,details:"",docData:{cover:"",name:"",is_public:"1",login_preview:"1"},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"change"}],username:[{required:!0,message:"请输入用户名",trigger:"change"}]},addManageData:{},role_list:[],showAddManage:!1,shwoEditRole:!1,selectUserId:"",selectUserRole:"",historyList:[],currentPageHistory:1,pageCountHistory:0,totalHistory:0}},watch:{id:function(t,e){console.log(t,e),this.active=0,this.getdetails()}},created:function(){this.getdetails()},methods:{onClickNav:function(t){2==t&&this.getHistory(),this.active=t},getdetails:function(){var t=this;this.$post("/admin/document/detail",{document_id:this.id}).then(function(e){t.details=e.data,t.docData={cover:e.data.cover||"",name:e.data.name,is_public:e.data.is_public?"2":"1",login_preview:e.data.login_preview?"2":"1"},t.role_list=e.data.role_list,t.addManageData.role=e.data.role_list[0].id})},getHistory:function(){var t=this;this.$post("/admin/operate-log/get-by-document ",{document_id:this.id,page:this.currentPageHistory}).then(function(e){t.historyList=e.data.data||[],t.pageCountHistory=e.data.page_count,t.totalHistory=e.data.total,t.$refs.historyTableRef.bodyWrapper.scrollTop=0})},handleAvatarSuccess:function(t){this.docData.cover=t.data.url},beforeAvatarUpload:function(t){var e="image/jpg"===t.type||"image/jpeg"===t.type||"image/png"===t.type,a=t.size/1024/1024<5;return e||this.$message.error("上传图片只支持jpg、jpeg、png格式!"),a||this.$message.error("上传图片大小不能超过 5MB!"),e&&a},saveDoc:function(){var t=this;this.$refs["docForm"].validate(function(e){e&&t.$post("/admin/document/update",s({document_id:t.details.id},t.docData)).then(function(){t.$message({type:"success",message:"保存成功!"})})})},delDoc:function(){var t=this;this.$confirm("此操作将永久删除该文档, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post("/admin/document/delete",{document_id:t.details.id}).then(function(){t.$parent.handleClose(),t.$message({type:"success",message:"删除成功!"})})})},editManage:function(t){this.selectUserId=t.id,this.selectUserRole=t.acl.role,this.shwoEditRole=!0},editRole:function(){var t=this;this.$post("/admin/document/operator",{user_id:this.selectUserId,document_id:this.id,permission:this.selectUserRole}).then(function(){t.getdetails(),t.shwoEditRole=!1})},removeManage:function(t){var e=this;this.$confirm("确定删除该操作员吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post("/admin/document/operator",{user_id:t,document_id:e.id}).then(function(){e.getdetails(),e.$message("删除成功！")})})},openAddManage:function(){this.addManageData={username:"",role:this.role_list[0].id||""},this.showAddManage=!0},addManage:function(){var t=this,e=!0;for(var a in this.details.operator)if(this.details.operator[a].username==this.addManageData.username)return this.$message("用户已存在"),void(e=!1);e&&this.$refs["addManageForm"].validate(function(e){e&&t.$post("/admin/document/operator",{user_name:t.addManageData.username,document_id:t.id,permission:t.addManageData.role}).then(function(){t.getdetails(),t.$message("添加成功！"),t.showAddManage=!1})})},uploadCover:function(){this.$refs.upload.uploadFiles(),console.log(this.$refs.upload.uploadFiles())}}},l=c,u=(a("ab0c"),a("2877")),d=Object(u["a"])(l,n,i,!1,null,null,null);e["a"]=d.exports},"4ec3":function(t,e,a){"use strict";a.d(e,"b",function(){return i}),a.d(e,"a",function(){return o}),a.d(e,"e",function(){return r}),a.d(e,"f",function(){return s}),a.d(e,"g",function(){return c}),a.d(e,"d",function(){return l}),a.d(e,"c",function(){return u});var n=a("a27e"),i=function(t){return Object(n["a"])({url:"/admin/document/create",data:t,method:"post"})},o=function(t){return Object(n["a"])({url:"/admin/chapter/create",data:t,method:"post"})},r=function(t){return Object(n["a"])({url:"/admin/document/chapterapi/getApiLabel",data:t,method:"get"})},s=function(t){return Object(n["a"])({url:"/admin/chapter/save",data:t,method:"post"})},c=function(t){return Object(n["a"])({url:"/admin/chapter/content",data:t,method:"post"})},l=function(t){return Object(n["a"])({url:"/admin/document/all",data:t,method:"post"})},u=function(t){return Object(n["a"])({url:"/admin/chapter/detail",data:t,method:"post"})}},"5dbc":function(t,e,a){var n=a("d3f4"),i=a("8b97").set;t.exports=function(t,e,a){var o,r=e.constructor;return r!==a&&"function"==typeof r&&(o=r.prototype)!==a.prototype&&n(o)&&i&&i(t,o),t}},"5eda":function(t,e,a){var n=a("5ca1"),i=a("8378"),o=a("79e5");t.exports=function(t,e){var a=(i.Object||{})[t]||Object[t],r={};r[t]=e(a),n(n.S+n.F*o(function(){a(1)}),"Object",r)}},"6b54":function(t,e,a){"use strict";a("3846");var n=a("cb7c"),i=a("0bfb"),o=a("9e1e"),r="toString",s=/./[r],c=function(t){a("2aba")(RegExp.prototype,r,t,!0)};a("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?c(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):s.name!=r&&c(function(){return s.call(this)})},"7f7f":function(t,e,a){var n=a("86cc").f,i=Function.prototype,o=/^\s*function ([^ (]*)/,r="name";r in i||a("9e1e")&&n(i,r,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},"85f2":function(t,e,a){t.exports=a("454f")},"8b97":function(t,e,a){var n=a("d3f4"),i=a("cb7c"),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,a){return o(t,a),e?t.__proto__=a:n(t,a),t}}({},!1):void 0),check:o}},"8e6e":function(t,e,a){var n=a("5ca1"),i=a("990b"),o=a("6821"),r=a("11e9"),s=a("f1ae");n(n.S,"Object",{getOwnPropertyDescriptors:function(t){var e,a,n=o(t),c=r.f,l=i(n),u={},d=0;while(l.length>d)a=c(n,e=l[d++]),void 0!==a&&s(u,e,a);return u}})},"8e95":function(t,e,a){},9093:function(t,e,a){var n=a("ce10"),i=a("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},"990b":function(t,e,a){var n=a("9093"),i=a("2621"),o=a("cb7c"),r=a("7726").Reflect;t.exports=r&&r.ownKeys||function(t){var e=n.f(o(t)),a=i.f;return a?e.concat(a(t)):e}},ab0c:function(t,e,a){"use strict";var n=a("8e95"),i=a.n(n);i.a},ac6a:function(t,e,a){for(var n=a("cadf"),i=a("0d58"),o=a("2aba"),r=a("7726"),s=a("32e9"),c=a("84f2"),l=a("2b4c"),u=l("iterator"),d=l("toStringTag"),f=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=i(p),m=0;m<g.length;m++){var v,b=g[m],h=p[b],y=r[b],_=y&&y.prototype;if(_&&(_[u]||s(_,u,f),_[d]||s(_,d,b),c[b]=f,h))for(v in n)_[v]||o(_,v,n[v],!0)}},bd86:function(t,e,a){"use strict";a.d(e,"a",function(){return o});var n=a("85f2"),i=a.n(n);function o(t,e,a){return e in t?i()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},f1ae:function(t,e,a){"use strict";var n=a("86cc"),i=a("4630");t.exports=function(t,e,a){e in t?n.f(t,e,i(0,a)):t[e]=a}}}]);
//# sourceMappingURL=chunk-6ab841fe.266780f7.js.map